{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>payment records list</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

  <style>
    th a {
      text-decoration: none;
      color: inherit;
    }

    th a:hover {
      text-decoration: underline;
    }
</style>


</head>
<body>
  {% include 'sidebar.html' %}
  <div class="main" style="min-height: 100vh;" >
    <div class="container bg-white p-4 rounded   addnewshadow" style="margin-top: 100px;">
      <h3 class="text-primary text-center">Payment Records</h3>
      <div class="filter-form mb-3">
        <form method="GET" class="d-flex flex-wrap gap-2">
          <input type="search" name="search" class="form-control w-auto" placeholder="Search by Invoice No ..." value="{{ search_query }}">
        
          <select name="ageing" class="form-select w-auto">
            <option value="">-- Filter by Ageing --</option>
            <option value="0-7" {% if ageing_selected == '0-7' %}selected{% endif %}>0–7 Days</option>
            <option value="8-15" {% if ageing_selected == '8-15' %}selected{% endif %}>8–15 Days</option>
            <option value="16-21" {% if ageing_selected == '16-21' %}selected{% endif %}>16–21 Days</option>
            <option value="22-30" {% if ageing_selected == '22-30' %}selected{% endif %}>22–30 Days</option>
            <option value="30+" {% if ageing_selected == '30+' %}selected{% endif %}>30+ Days</option>
          </select>
        
          <button type="submit" class="btn btn-primary">Search</button>
        </form>
      </div>


<table class="table table-striped">
  <thead class="table-dark">
    <tr>
      <th>Invoice No</th>
      <th>Customer Name</th>
      <th>
        <a href="?{% if search_query %}search={{ search_query|urlencode }}&{% endif %}{% if ageing_selected %}ageing={{ ageing_selected|urlencode }}&{% endif %}due_order={% if due_order == 'asc' %}desc{% else %}asc{% endif %}">
          Due Date
          {% if due_order == 'asc' %}▲{% elif due_order == 'desc' %}▼{% endif %}
        </a>
      </th>
      <th>Total Amount</th>
      <th>
        <a href="?{% if search_query %}search={{ search_query|urlencode }}&{% endif %}{% if ageing_selected %}ageing={{ ageing_selected|urlencode }}&{% endif %}remain_amount={% if remain_amount == 'asc' %}desc{% else %}asc{% endif %}">
          Remain Amount
          {% if remain_amount == 'asc' %}▲{% elif remain_amount == 'desc' %}▼{% endif %}
        </a>
      </th>
      <th>Ageing</th>
    </tr>
  </thead>
  <tbody>
    {% for i in payments %}
    <tr>
      <td><a href="{% url 'payment_records_details' pk=i.main_invoice.id %}">{{ i.main_invoice.tax_invoice_no }}</a></td>
      <td>{{ i.main_invoice.customer.fullname }}</td>
      <td>{{ i.payment_date }}</td>
      <td>{{ i.main_invoice.grand_total }}</td>
      <td>{{ i.amount_remaining }}</td>
      <td>{{ i.ageing }}</td>
    </tr>
    {% empty %}
    <tr>
      <td colspan="6" class="text-center">No payment records found.</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

      </div>


  </div>
  <div class="container-fluid footer" style="background-color: #f7f7f7; width:100%;">
    <div class="row p-3">
      <div class="col-md-12 text-center">
        <p style="margin: 0; font-weight: 600; color:#000000">
          © 2025. Powered by
          <img src="{% static 'images/crono.png' %}" alt="Chronoanalytics Logo"
            style="height: 20px; vertical-align: middle;">
          <a href="http://www.chronoanalytics.in/"
            style="text-decoration: none; background: linear-gradient(to right, #2575fc, #6a11cb); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-size: 1.1rem;">Chronoanalytics
            Solution</a>
          All Rights Reserved.
        </p>
      </div>
      <div class="col-md-12 text-center">
        <p style="font-weight: 600; color:#000000">
          © 2025. Marketed by
          <img src="{% static 'images/TeimLogo.png' %}" alt="Teim Logo" style="height: 20px; vertical-align: middle;">
          <a href="http://teim.in/"
            style="text-decoration: none; background: linear-gradient(to right, #2575fc, #6a11cb); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-size: 1.1rem;">TEIM</a>
          All Rights Reserved.
        </p>
      </div>
    </div>
  </div>



<!-- Sidebar section -->
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const menuItems = document.querySelectorAll('.sidebar ul li.has-submenu');
      menuItems.forEach(item => {
        item.addEventListener('click', function () {
          const submenu = this.querySelector('.submenu');
          const arrow = this.querySelector('.arrow-down');

          // Hide all other submenus
          menuItems.forEach(otherItem => {
            if (otherItem !== this) {
              const otherSubmenu = otherItem.querySelector('.submenu');
              const otherArrow = otherItem.querySelector('.arrow-down');
              if (otherSubmenu) {
                otherSubmenu.style.display = 'none';
                if (otherArrow.classList.contains('arrow-up')) {
                  otherArrow.classList.remove('arrow-up');
                }
              }
            }
          });

          // Toggle current submenu
          if (submenu) {
            submenu.style.display = (submenu.style.display === 'block' ? 'none' : 'block');
            arrow.classList.toggle('arrow-up');
          }
        });
      });
    });
    
  </script>
</body>
</html>
